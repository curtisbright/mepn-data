\documentclass[12pt]{article}

\usepackage{amsmath,amssymb,amsthm,amscd,amsfonts}

\usepackage{fullpage}

\usepackage{mathtools}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}

\def\subw{\triangleleft}
\DeclareMathOperator\supe{sup}
\DeclareMathOperator\subb{sub}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{test}{Test}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{conjecture}[theorem]{Conjecture}

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{problem}[theorem]{Problem}

\newcommand{\0}{\mathtt{0}}
\newcommand{\1}{\mathtt{1}}
\newcommand{\2}{\mathtt{2}}
\newcommand{\3}{\mathtt{3}}
\newcommand{\4}{\mathtt{4}}
\newcommand{\5}{\mathtt{5}}
\newcommand{\6}{\mathtt{6}}
\newcommand{\7}{\mathtt{7}}
\newcommand{\8}{\mathtt{8}}
\newcommand{\9}{\mathtt{9}}

\title{Minimal Elements for the Prime Numbers}

\author{Curtis Bright\\
School of Computer Science\\
University of Waterloo\\
Waterloo, ON  N2L 3G1\\
Canada\\
\ \\
Raymond Devillers\\
D\'epartement d'Informatique, CP 212\\
Universit\'e Libre de Bruxelles \\
B-1050 Bruxelles\\
Belgium\\
\ \\
Jeffrey Shallit \\
School of Computer Science\\
University of Waterloo\\
Waterloo, ON  N2L 3G1\\
Canada}

\begin{document}

\maketitle

\begin{abstract}
We say a string of symbols $s$ is {\it minimal} for a language $L$
if $s$ is a member of $L$, and it is not possible to obtain another 
member of $L$ by striking out one or more symbols from $s$.  Although
the set $M(L)$ of minimal strings is necessarily finite, determining
it explicitly for a given $L$ can be a difficult computational problem.  
We use some number-theoretic heuristics to compute $M(L)$, where $L$
is the language of base-$b$ representations of the prime numbers,
for $2 \leq b \leq 28$.
\end{abstract}

\section{Introduction}

Problems about the digits of prime numbers have a long history, and many
of them are still unsolved.  For example, are there infinitely many
primes, all of whose base-$10$ digits are $1$?  Currently,
there are only five
known, corresponding to $(10^p-1)/9$ for $p = 2, 19, 23, 317, $ and
$1031$.    It seems likely that four more are given by
$p = 49081, 86453, 109297, 270343$, but this has not yet been
rigorously proven.

Another problem on the digits of primes was introduced by the
third author \cite{Sh00}.  To describe it, we need some definitions.
We say that a string $x$ is a {\it subword} of a string $y$, and 
we write $x \subw y$, if 
one can strike out zero or more symbols of $y$ to get $x$.
For example, {\tt string} is a subword of
{\tt Meistersinger}.  
(In the literature, this concept is sometimes called a ``scattered
subword'' or ``substring''.)
A {\it language} is a set of strings.  A string $s$ is {\it minimal}
for $L$ if  (a) $s \in L$ and (b) if $x \in L$ and $x \subw s$, then
$x = s$.    The set of all minimal strings of $L$ is denoted $M(L)$.

In this paper, we describe a heuristic
technique for determining $M(L_b)$ in the
case where $L_b$ consists of the representations, in base $b$, of the
the prime numbers $\lbrace 2, 3, 5, \cdots \rbrace$.  We obtain
a complete characterization of $M(L_b)$ for bases
$2 \leq b \leq 16$.   For $17 \leq b \leq 28$, we obtain
results that allow us to ``almost'' completely characterize this set.

In what follows, if $x$ is a string of symbols over the alphabet
$\Sigma_b = \lbrace \0, \1, \ldots, b-1 \rbrace$\footnote{When
$b>10$ we supplement the Arabic numerals with the
alphabetic characters \texttt{A}, \texttt{B}, \texttt{C}, $\dotsc$.}, we let 
$[x]_b$ denote the evaluation of $x$ in base $b$ (starting with the
most significant digit).  We let $(x)_b$ be the canonical representation
of $x$ in base-$b$, that is, the representation without leading zeroes.
The set of all canonical representations in base $b$ is denoted
$C_b$.

\section{Why minimal sets are interesting}

The minimal set $M(L)$ of a language $L$ is interesting because it
allows us to compute two natural and related languages,
defined as follows:
\begin{align*}
\subb(L) &= \lbrace x \in \Sigma^* \ : \ 
	\text{ there exists } y \in L \text{ such that } x \subw y \rbrace  ;\\
\supe(L) &= \lbrace x \in \Sigma^* \ : \ 
	\text{ there exists } y \in L \text{ such that } y \subw x \rbrace .
\end{align*}

An amazing fact is that $\subb(L)$ and $\supe(L)$ are always regular.
This follows from
the following classical theorem due to Higman \cite{Hi52} and
Haines \cite{Ha69}.

\begin{theorem}
For every language $L$, there are only finitely many minimal strings.
\end{theorem}

Indeed, we have $\supe(L) = \bigcup_{x \in M(L)} \supe (\lbrace x \rbrace)$
and $\Sigma^* - \subb(L) = \supe(M(\Sigma^* - \supe(L)))$.

\section{Why the problem is hard}

Determining $M(L)$ for arbitrary $L$
is in general unsolvable, and can be difficult even for
relatively simple $L$ \cite{GHK07}.

The following is a ``semi-algorithm'' that 
is guaranteed to produce $M(L)$, but not so easy to implement:
\bigskip
\noindent (1) $ M := \emptyset$ \\
\noindent (2) while ($L \not= \emptyset$) do \\
\quad (3) choose $x$, a shortest string in $L$ \\
\quad (4) $ M := M \ \cup \ \lbrace  x \rbrace$ \\
\quad (5) $ L := L - \supe(\lbrace x \rbrace) $ \\

In practice, for arbitrary $L$,
we cannot feasibly carry out step (5).  Instead, we work
with $L'$, some regular overapproximation to $L$, until we can show $L' =
\emptyset$ (which implies $L = \emptyset$).  In practice,
$L'$ is usually chosen to be a finite union of sets of the form 
$L_1 L_2^* L_3$, where each of $L_1, L_2, L_3$ is finite.
In the case we consider in this paper,
we then have to determine whether such a language contains
a prime or not.

However, it is not even known if the following simpler decision problem is 
recursively solvable:

\medskip

\begin{problem}
Given strings $x, y, z$, and a base $b$, does there exist a prime
number whose base-$b$ expansion is of the form $x \overbrace{yy\cdots y}^n z$
for some $n \geq 0$?
\end{problem}

\medskip

An algorithm to solve this problem, for example, would allow us to decide
if there are any additional Fermat primes (of the form $2^{2^n}+1$)
other than the known ones (corresponding to $n = 0,1,2,3,4$).

Therefore, in practice, we are forced to try to rule out prime
representations based on modular techniques and factorizations.
This is discussed in the next section.

\section{Some useful lemmas}
It will be necessary for our algorithm to determine if families of the
form $xL^*z$ contain a prime or not.  One way of showing such families
do not contain a prime is to show that some $N>1$ 
divides every such number.  At first glance, this would require
checking that $N$ divides $xL^nz$ for $n=0$, $1$, $2$, $\dotsc$.
However, the following lemma shows that it is only necessary to check
the cases $n=0$ and $1$.

\begin{lemma}\label{lemone}
Let $x$, $z\in \Sigma^*_b$, and let $L\subseteq\Sigma^*_b$.
Then $N$ divides $[xz]_b$ and all numbers of the form $[xLz]_b$
if and only if $N$ divides all numbers of the form $[xL^*z]_b$.
\end{lemma}
\begin{proof}
Let $y=y_1\dotsm y_n\in L^*$, where $y_1$, $\dotsc$, $y_n\in L$.  
By telescoping we have
\[ [xyz]_b - [xz]_b = \sum_{i=1}^{n}([xy_{i}y_{i+1}\dotsm y_n z]_b-[xy_{i+1}\dotsm y_n z]_b) . \]
Cancelling the final base-$b$ digits in the summand difference 
which are identical, this becomes
\[ [xyz]_b = [xz]_b + \sum_{i=1}^{n}b^{\lvert{y_{i+1}\dotsm y_n z}\rvert}([xy_i]_b-[x]_b) . \]
But $b^{\lvert z\rvert}([xy_i]_b-[x]_b)=[xy_iz]_b-[xz]_b$ by 
adding and subtracting $[z]_b$, so we have
\[ [xyz]_b = [xz]_b + \sum_{i=1}^{n}b^{\vert{y_{i+1}\dotsm y_n}\rvert}([xy_iz]_b-[xz]_b) . \]
Since $N\mid[xz]_b$ and $N\mid[xy_iz]_b$ for each $1\leq i\leq n$,
 it follows that $N\mid[xyz]_b$.
\end{proof}

In practice, our algorithm employs this lemma in the following form.
\begin{corollary}
If $[xz]_b>0$ is not prime and $\gcd([xz]_b,[xy_1z]_b,\dotsc,[xy_nz]_b)>1$
 then all numbers of the form $[x\{y_1,\dotsc,y_n\}^*z]_b$ are composite.
\end{corollary}
\begin{proof}
By Lemma~\ref{lemone}, $N:=\gcd([xz]_b,[xy_1z]_b,\dotsc,[xy_nz]_b)>1$ divides all numbers of the form $[x\{y_1,\dotsc,y_n\}^*z]_b$.
If $N<[xz]_b$ then $N$ is a proper divisor of each such number, and if 
$N=[xz]_b$ then $N$ itself is not prime (and likewise for all multiples of $N$).
\end{proof}

\begin{example}
Since $\gcd(49, 469)=7$, every number of the form $\4\6^*\9$ is divisible 
by $7$ in base~10.  Since $49$ is not prime, no number of the form 
$\4\6^*\9$ is prime in base 10.
\end{example}

\begin{lemma}
Let $x$, $y$, $z\in\Sigma^*_b$, and let $g:=\gcd([y]_b,b-1)$, 
$X:=([y]_b+(b-1)[x]_b)/g$, and $Y:=(b^{\lvert{z}\rvert}[y]_b-(b-1)[z]_b)/g$.
If $b$, $X$, and $Y$ are all squares and 
$\sqrt{b^{\lvert z\rvert}X}-\sqrt{Y}>(b-1)/g$, then all numbers of the form
 $[xy^*z]_b$ are composite.
\end{lemma}
\begin{proof}
Expanding out the base-$b$ expansion of $xy^nz$, one derives
\begin{align*}
[xy^nz]_b &= b^{\lvert z\rvert+n}[x]_b + b^{\lvert z\rvert}\frac{b^n-1}{b-1}[y]_b + [z]_b \\
&= \frac{b^{\lvert z\rvert+n}X-Y}{(b-1)/g} . 
%= \frac{(\sqrt{Xb^{\lvert z\rvert+n}}+\sqrt{Y})(\sqrt{Xb^{\lvert z\rvert+n}}-\sqrt{Y})}{(b-1)/g}
\end{align*}
Since $b$, $X$, and $Y$ are all squares the numerator factors as a 
difference of squares.  By the size condition both factors are 
strictly larger than the
denominator, and so the factorization is nontrivial.
\end{proof}

\begin{example}
Let $b:=16$, $x:=\4$, $y:=\4$, and $z:=\1$.  Then $g=1$, $X=8^2$, $Y=7^2$, and
\[ [\4\4^n\1]_{16} = \frac{(4^{n+1}\cdot8+7)(4^{n+1}\cdot8-7)}{15} . \]
Since $4\cdot8-7>15$, this factorization is nontrivial and no number of 
the form $\4\4^*\1$ is prime in base 16.
\end{example}

\section{Our heuristic algorithm}

\section{Results}
A summary of the results of our algorithm is presented in Figure~\ref{resultsfig}.
For each base $b$ between 2 and 16 the size and width of $M(L_b)$ is given.
For bases between 17 and 28 a lower bound on the size and width of $M(L_b)$ is given,
along with the number of families of the form $xy^*z$ for which no prime could be found,
nor could the family be ruled out as only containing composites.

The results assume that a number which has passed several Miller--Rabin
tests is in fact prime, since in some cases (e.g., $b=13$) a candidate element of $M(L_b)$
is too long to be proven prime rigorously.

\begin{figure}\[\begin{array}{c@{\qquad}c@{\qquad}c@{\qquad}c}
b & \lvert M(L_b)\rvert & \max\limits_{x\in M(L_b)}\lvert x\rvert & \parbox{5em}{\centering\# unsolved\\families} \\ \hline
2 & 2 & 2 & 0 \\ 
3 & 3 & 3 & 0 \\ 
4 & 3 & 2 & 0 \\ 
5 & 8 & 5 & 0 \\ 
6 & 7 & 5 & 0 \\ 
7 & 9 & 5 & 0 \\ 
8 & 15 & 9 & 0 \\ 
9 & 12 & 4 & 0 \\ 
10 & 26 & 8 & 0 \\ 
11 & 152 & 45 & 0 \\ 
12 & 17 & 8 & 0 \\ 
13\mathrlap{^*} & 228 & 32021 & 0 \\ 
14 & 240 & 86 & 0 \\ 
15 & 100 & 107 & 0 \\ 
16\mathrlap{^*} & 483 & 3545 & 0 \\ 
17\mathrlap{^*} & \geq1278 & \geq7093 & 2 \\ 
18 & 50 & 33 & 0 \\ 
19\mathrlap{^*} & \geq3460 & \geq42996 & 3 \\ 
20 & 651 & 449 & 0 \\ 
21\mathrlap{^*} & \geq2598 & \geq1634 & 3 \\ 
22 & 1242 & 764 & 0 \\ 
23\mathrlap{^*} & \geq6018 & \geq23278 & 4 \\ 
24 & 306 & 100 & 0 \\ 
25\mathrlap{^*} & \geq17591 & \geq18470 & 18 \\ 
26\mathrlap{^*} & \geq5662 & \geq8773 & 2 \\ 
27\mathrlap{^*} & \geq17207 & \geq50632 & 9 \\ 
28\mathrlap{^*} & \geq5782 & \geq4242 & 2 
\end{array}\]
\begin{center}$^*$Data based on results of Miller--Rabin pseudoprimality tests.\end{center}
\caption{Summary of results for each base $b$.}
\label{resultsfig}
\end{figure}

\subsection{Unsolved families}
Base 17: $\mathtt{49^*}$, $\mathtt{F19^*}$ \\
Base 19: $\mathtt{4F0^*6}$, $\mathtt{EE16^*}$, $\mathtt{FG6^*}$ \\
Base 21: $\mathtt{40^*9G}$, $\mathtt{CF^*0K}$, $\mathtt{G0^*FK}$ \\
Base 23: $\mathtt{80^*1}$, $\mathtt{80^*81}$, $\mathtt{96E^*}$, $\mathtt{9E^*}$ \\
Base 25: $\mathtt{4F^*OO}$, $\mathtt{6MF^*9}$, $\mathtt{96^*M}$, $\mathtt{CM1^*}$, $\mathtt{EE1^*}$, $\mathtt{E1^*E}$, $\mathtt{E^*FOO}$, $\mathtt{EFO^*}$, $\mathtt{F1^*F1}$, $\mathtt{F0^*KO}$, $\mathtt{F0K^*O}$, $\mathtt{LOL^*8}$, $\mathtt{LO^*KC}$, $\mathtt{LF^*KI}$, $\mathtt{M1^*F1}$, $\mathtt{MF^*0F6}$, $\mathtt{M10^*8}$, $\mathtt{OL^*8}$ \\
Base 26: $\mathtt{A^*6F}$, $\mathtt{I^*GL}$ \\
Base 27: $\mathtt{80^*9A}$, $\mathtt{999G^*}$, $\mathtt{A0^*PM}$, $\mathtt{CA0F^*A}$, $\mathtt{CL^*E}$, $\mathtt{EI^*F8}$, $\mathtt{F^*9FM}$, $\mathtt{L^*0G}$, $\mathtt{L^*G}$ \\
Base 28: $\mathtt{O4O^*9}$, $\mathtt{OA^*F}$

\section{Some additional strategies}

\section{Composite numbers}

One can also consider the companion problem of determining the
minimal elements for the composite numbers
$\lbrace 4,6,8,9,10, 12, \ldots \rbrace $.  
Here, in contrast with the primes, we have

\begin{theorem}
The following decision problem is recursively solvable:  given
a base $b$ and a DFA $M$ accepting a language $L \subseteq 
C_b$, does $M$ accept the base-$b$ representation of a composite 
number?
\end{theorem}

This follows immediately from

\begin{theorem}
Suppose $L$ is a regular language, accepted by a 
deterministic finite automaton $M$ of $n$ states.  Then
if $M$ accepts a composite number expressed in base $b$, it must
accept one whose base-$b$ representation has at most
$n(b^{2n} + 1)$ digits.
\end{theorem}

\begin{proof}
If $L$ is finite, then the longest string accepted by $M$ has
at most $n-1$ digits, and $n-1 < n(b^{2n} + 1)$.

Otherwise $L$ is infinite.  Then $M$ accepts a string of length
$\ell$ with $n < \ell \leq 2n$ that can be pumped (as in the
pumping lemma.  That is, there exists $x \in L$ such that
$x = uvw$ with $|uv| \leq n$.  Then a classical proof of the
non-regularity of the prime numbers 
(e.g., \cite[Example 3.2, p.\ 57]{HU79})
shows that either $x$ is the representation of a composite 
number (in which case $|x| \leq 2n \leq n(b^{2n} + 1)$)
or $u v^p w$ is composite, where $p = [x]_b$.  
Our bound now follows.
\end{proof}

\section{Open problems}

To illustrate once more the difficult of computing $M(L)$, we recall
an open problem from \cite{Sh00}:

\begin{problem} 
Let $L = \lbrace {\tt 1, 2, 4, 8, 16, 32, 64, } \ldots \rbrace$, the
base-$10$ representation of the powers of $2$.  
Is it the case that
$$ M(L) = \lbrace 1, 2, 4, 8, 65536 \rbrace ? $$
\end{problem}

This would follow, for example, if we could prove that every power
of $16$ greater than $65536$ contained at least one of the digits
$\lbrace 1,2,4, 8 \rbrace$.  But this seems beyond current capabilities.


\bibliographystyle{plain}
\begin{thebibliography}{9}

\bibitem{GHK07}  H. Gruber, M. Holzer, and M. Kutrib.
\newblock The size of Higman-Haines sets.
\newblock {\it Theoret. Comput. Sci.} {\bf 387} (2007), 167--176.

\bibitem{GHK09}  H. Gruber, M. Holzer, and M. Kutrib.
\newblock More on the size of Higman-Haines sets:  effective constructions.
\newblock {\it Fundam. Inform.} {\bf 91} (2009), 105--121.

\bibitem{Ha69}  L. H. Haines.
\newblock On free monoids partially ordered by embedding.
\newblock {\it J. Combinatorial Theory} {\bf 6} (1969), 94--98.

\bibitem{Hi52}  G. Higman.
\newblock Ordering by divisibility in abstract algebras.
\newblock {\it Proc. London Math. Soc.} (3) {\bf 2} (1952), 326--336.

\bibitem{HU79}  J. E. Hopcroft and J. D. Ullman.
\newblock {\it Introduction to Automata Theory, Languages, and Computation},
Addison-Wesley, 1979.

\bibitem{Sh00}  J. Shallit.
\newblock Minimal primes.
\newblock {\it J. Recreational Math.} {\bf 30} (2) (200), 113--117.

\end{thebibliography}

\end{document}
